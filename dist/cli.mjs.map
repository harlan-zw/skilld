{"version":3,"file":"cli.mjs","names":[],"sources":["../src/optimize.ts","../src/cli.ts"],"sourcesContent":["/**\n * LLM-based documentation optimization\n * Extracts non-obvious best practices and public APIs from raw docs\n */\n\nimport { execSync } from 'node:child_process'\nimport { dirname, join } from 'node:path'\nimport { fileURLToPath } from 'node:url'\nimport type { AgentType } from './agents'\n\nconst __dirname = dirname(fileURLToPath(import.meta.url))\nconst SKILL_CREATOR_PATH = join(__dirname, '../skills/skill-creator/SKILL.md')\n\nexport interface AvailableModel {\n  id: 'haiku' | 'sonnet' | 'opus' | 'gemini-flash' | 'gemini-pro'\n  name: string\n  description: string\n  available: boolean\n  recommended?: boolean\n}\n\n/**\n * Get available optimization models\n */\nexport async function getAvailableModels(): Promise<AvailableModel[]> {\n  const models: AvailableModel[] = []\n\n  // Check if claude CLI is available\n  const hasClaude = (() => {\n    try {\n      execSync('which claude', { stdio: 'ignore' })\n      return true\n    }\n    catch {\n      return false\n    }\n  })()\n\n  // Check if gemini CLI is available\n  const hasGemini = (() => {\n    try {\n      execSync('which gemini', { stdio: 'ignore' })\n      return true\n    }\n    catch {\n      return false\n    }\n  })()\n\n  if (hasClaude) {\n    models.push(\n      { id: 'haiku', name: 'Claude Haiku', description: 'Fast, cheap', available: true, recommended: true },\n      { id: 'sonnet', name: 'Claude Sonnet', description: 'Balanced', available: true },\n      { id: 'opus', name: 'Claude Opus', description: 'Most capable', available: true },\n    )\n  }\n\n  if (hasGemini) {\n    models.push(\n      { id: 'gemini-flash', name: 'Gemini 3 Flash', description: 'Fast', available: true, recommended: true },\n      { id: 'gemini-pro', name: 'Gemini 3 Pro', description: 'Most capable', available: true },\n    )\n  }\n\n  // Check Anthropic SDK\n  if (process.env.ANTHROPIC_API_KEY) {\n    if (!hasClaude) {\n      models.push(\n        { id: 'haiku', name: 'Claude Haiku (API)', description: 'Fast, cheap', available: true, recommended: true },\n        { id: 'sonnet', name: 'Claude Sonnet (API)', description: 'Balanced', available: true },\n      )\n    }\n  }\n\n  return models\n}\n\nfunction buildPrompt(packageName: string, packageDocs: string): string {\n  return `IMPORTANT: YOU MUST USE THIS SKILL: ${SKILL_CREATOR_PATH}\n\nGenerate a SKILL.md for the \"${packageName}\" package.\n\n## Focus Areas (IMPORTANT)\n\n1. **New API changes that affect best practices** - What's the modern way to do things? What old patterns should be replaced?\n2. **Breaking changes from recent versions** - What changed that developers need to update?\n3. **Non-obvious gotchas** - Edge cases, common mistakes, things that silently fail\n4. **Performance patterns** - What's expensive, what to avoid, what to prefer\n\n## Rules\n\n- Output ONLY the markdown content, no explanations\n- Skip basics that any LLM already knows\n- Skip installation, badges, marketing\n- Keep under 400 lines\n- Include version numbers when APIs changed (e.g., \"3.5+\")\n\nPackage docs:\n\n${packageDocs}\n`\n}\n\nexport type OptimizeModel = AvailableModel['id']\n\n/**\n * Optimize documentation using the detected LLM agent\n * Falls back gracefully if no LLM available\n */\nexport async function optimizeDocs(\n  content: string,\n  packageName: string,\n  agent: AgentType | null,\n  model: OptimizeModel = 'haiku',\n): Promise<{ optimized: string, wasOptimized: boolean }> {\n  // Handle Gemini models\n  if (model.startsWith('gemini-')) {\n    const result = await tryGemini(content, packageName, model)\n    if (result) return { optimized: result, wasOptimized: true }\n    return { optimized: content, wasOptimized: false }\n  }\n\n  // Try Claude Code first (most common)\n  if (agent === 'claude-code' || !agent) {\n    const result = await tryClaudeCode(content, packageName, model)\n    if (result) return { optimized: result, wasOptimized: true }\n  }\n\n  // Fallback: try Anthropic SDK if API key available\n  if (process.env.ANTHROPIC_API_KEY) {\n    const result = await tryAnthropicSDK(content, packageName, model)\n    if (result) return { optimized: result, wasOptimized: true }\n  }\n\n  // No LLM available, return original\n  return { optimized: content, wasOptimized: false }\n}\n\nasync function tryClaudeCode(content: string, packageName: string, model: OptimizeModel): Promise<string | null> {\n  try {\n    execSync('which claude', { stdio: 'ignore' })\n\n    const prompt = buildPrompt(packageName, content)\n    const { spawnSync } = await import('node:child_process')\n\n    const result = spawnSync('claude', ['--model', model, '--print'], {\n      input: prompt,\n      encoding: 'utf-8',\n      stdio: ['pipe', 'pipe', 'inherit'], // inherit stderr for progress\n      maxBuffer: 10 * 1024 * 1024,\n      timeout: 180_000,\n    })\n\n    if (result.error || result.status !== 0) return null\n    return result.stdout.trim()\n  }\n  catch {\n    return null\n  }\n}\n\nasync function tryGemini(content: string, packageName: string, model: OptimizeModel): Promise<string | null> {\n  try {\n    execSync('which gemini', { stdio: 'ignore' })\n\n    const prompt = buildPrompt(packageName, content)\n    const geminiModel = GEMINI_MODEL_MAP[model] || 'gemini-3-flash-preview'\n\n    const { spawnSync } = await import('node:child_process')\n    const result = spawnSync('gemini', ['--model', geminiModel], {\n      input: prompt,\n      encoding: 'utf-8',\n      stdio: ['pipe', 'pipe', 'inherit'], // inherit stderr for progress\n      maxBuffer: 10 * 1024 * 1024,\n      timeout: 180_000,\n    })\n\n    if (result.error || result.status !== 0) return null\n    return result.stdout.trim()\n  }\n  catch {\n    return null\n  }\n}\n\nconst CLAUDE_MODEL_MAP: Record<string, string> = {\n  haiku: 'claude-3-5-haiku-latest',\n  sonnet: 'claude-sonnet-4-20250514',\n  opus: 'claude-opus-4-20250514',\n}\n\nconst GEMINI_MODEL_MAP: Record<string, string> = {\n  'gemini-flash': 'gemini-3-flash-preview',\n  'gemini-pro': 'gemini-3-pro-preview',\n}\n\nasync function tryAnthropicSDK(content: string, packageName: string, model: OptimizeModel): Promise<string | null> {\n  try {\n    // Dynamic import to avoid requiring the SDK if not used\n    // @ts-expect-error - optional dependency\n    const { default: Anthropic } = await import('@anthropic-ai/sdk')\n    const client = new Anthropic()\n\n    const response = await client.messages.create({\n      model: CLAUDE_MODEL_MAP[model] || 'claude-3-5-haiku-latest',\n      max_tokens: 8192,\n      messages: [{\n        role: 'user',\n        content: buildPrompt(packageName, content),\n      }],\n    })\n\n    const textBlock = response.content.find((b: { type: string, text?: string }) => b.type === 'text') as { type: 'text', text: string } | undefined\n    return textBlock?.text || null\n  }\n  catch {\n    return null\n  }\n}\n","#!/usr/bin/env node\nimport { existsSync, mkdirSync, readFileSync, writeFileSync } from 'node:fs'\nimport { homedir } from 'node:os'\nimport { dirname, join } from 'node:path'\nimport { defineCommand, runMain } from 'citty'\nimport consola from 'consola'\nimport { resolvePackageDocs } from './npm'\nimport { agents, detectCurrentAgent, sanitizeName } from './agents'\nimport { type OptimizeModel, getAvailableModels, optimizeDocs } from './optimize'\n\nconst main = defineCommand({\n  meta: {\n    name: 'skilld',\n    description: 'Sync package documentation for agentic use',\n  },\n  args: {\n    package: {\n      type: 'positional',\n      description: 'Package name to sync docs for',\n      required: false,\n    },\n    global: {\n      type: 'boolean',\n      alias: 'g',\n      description: 'Install globally to ~/.claude/skills',\n      default: false,\n    },\n    agent: {\n      type: 'string',\n      alias: 'a',\n      description: 'Target specific agent (claude-code, cursor, windsurf, etc.)',\n    },\n    model: {\n      type: 'string',\n      alias: 'm',\n      description: 'LLM model (haiku, sonnet, opus, gemini-flash, gemini-pro)',\n    },\n    yes: {\n      type: 'boolean',\n      alias: 'y',\n      description: 'Skip prompts, use defaults',\n      default: false,\n    },\n  },\n  async run({ args }) {\n    const currentAgent = args.agent as keyof typeof agents | undefined ?? detectCurrentAgent()\n\n    if (!currentAgent) {\n      consola.warn('Could not detect agent. Use --agent <name>')\n      consola.info('Supported: ' + Object.keys(agents).join(', '))\n      return\n    }\n\n    const agent = agents[currentAgent]\n    consola.info(`Target: ${agent.displayName}`)\n\n    if (!args.package) {\n      consola.warn('Usage: skilld <package-name>')\n      return\n    }\n\n    // Determine model - from flag, prompt, or default\n    let model: OptimizeModel = 'haiku'\n\n    if (args.model) {\n      model = args.model as OptimizeModel\n    }\n    else if (!args.yes) {\n      const availableModels = await getAvailableModels()\n      if (availableModels.length > 0) {\n        const modelChoice = await consola.prompt('Select LLM for SKILL.md generation:', {\n          type: 'select',\n          options: availableModels.map(m => ({\n            label: m.recommended ? `${m.name} (Recommended)` : m.name,\n            value: m.id,\n            hint: m.description,\n          })),\n          initial: availableModels.find(m => m.recommended)?.id || availableModels[0]?.id,\n        }) as string\n        model = modelChoice as OptimizeModel\n      }\n    }\n\n    await syncPackage(args.package, {\n      global: args.global,\n      agent: currentAgent,\n      model,\n    })\n  },\n})\n\nasync function syncPackage(packageName: string, config: {\n  global: boolean\n  agent: keyof typeof agents\n  model: 'haiku' | 'sonnet' | 'opus' | 'gemini-flash' | 'gemini-pro'\n}) {\n  consola.start(`Resolving ${packageName}...`)\n\n  const resolved = await resolvePackageDocs(packageName)\n  if (!resolved) {\n    consola.error(`Could not find docs for: ${packageName}`)\n    return\n  }\n\n  const agent = agents[config.agent]\n  const baseDir = config.global\n    ? join(homedir(), '.claude/skills')\n    : join(process.cwd(), agent.skillsDir)\n\n  const skillDir = join(baseDir, sanitizeName(packageName))\n  const docsDir = join(skillDir, 'docs')\n\n  mkdirSync(docsDir, { recursive: true })\n\n  // Fetch llms.txt and download all referenced .md files\n  let llmsContent: string | null = null\n  if (resolved.llmsUrl) {\n    consola.start('Fetching llms.txt...')\n    llmsContent = await fetchText(resolved.llmsUrl)\n    if (llmsContent) {\n      // Normalize links to relative paths for local access\n      const normalizedLlms = llmsContent.replace(/\\]\\(\\/([^)]+\\.md)\\)/g, '](./docs/$1)')\n      writeFileSync(join(skillDir, 'llms.txt'), normalizedLlms)\n      consola.success('Saved llms.txt')\n\n      // Parse and download all .md files\n      const baseUrl = resolved.docsUrl || new URL(resolved.llmsUrl).origin\n      const mdUrls = parseMarkdownLinks(llmsContent)\n\n      if (mdUrls.length > 0) {\n        consola.start(`Downloading ${mdUrls.length} doc files...`)\n        let downloaded = 0\n\n        for (const mdPath of mdUrls) {\n          const url = mdPath.startsWith('http') ? mdPath : `${baseUrl.replace(/\\/$/, '')}${mdPath}`\n          const content = await fetchText(url)\n          if (content && content.length > 100) {\n            // Save with path structure: docs/guide/essentials/reactivity.md\n            const localPath = mdPath.startsWith('/') ? mdPath.slice(1) : mdPath\n            const filePath = join(docsDir, localPath)\n            mkdirSync(dirname(filePath), { recursive: true })\n            writeFileSync(filePath, content)\n            downloaded++\n          }\n        }\n\n        consola.success(`Downloaded ${downloaded}/${mdUrls.length} docs`)\n      }\n    }\n  }\n\n  // Fallback to README\n  if (resolved.readmeUrl && !existsSync(join(docsDir, 'llms.txt'))) {\n    consola.start('Fetching README...')\n    const content = await fetchReadme(resolved.readmeUrl)\n    if (content) {\n      writeFileSync(join(docsDir, 'README.md'), content)\n      consola.success('Saved README.md')\n    }\n  }\n\n  // Generate SKILL.md using Haiku\n  // Read best-practices docs from local files\n  let docsContent: string | null = null\n\n  if (llmsContent) {\n    // Find and read best-practices related docs\n    const bestPracticesPaths = parseMarkdownLinks(llmsContent).filter(p =>\n      p.includes('/style-guide/') || p.includes('/best-practices/') || p.includes('/typescript/'),\n    )\n\n    const sections: string[] = []\n    for (const mdPath of bestPracticesPaths) {\n      const localPath = mdPath.startsWith('/') ? mdPath.slice(1) : mdPath\n      const filePath = join(docsDir, localPath)\n      if (existsSync(filePath)) {\n        const content = readFileSync(filePath, 'utf-8')\n        sections.push(`# ${mdPath}\\n\\n${content}`)\n      }\n    }\n\n    docsContent = sections.length > 0 ? sections.join('\\n\\n---\\n\\n') : llmsContent\n  }\n  else if (existsSync(join(docsDir, 'README.md'))) {\n    docsContent = readFileSync(join(docsDir, 'README.md'), 'utf-8')\n  }\n\n  if (docsContent) {\n    consola.start(`Generating SKILL.md with ${config.model}...`)\n    const { optimized, wasOptimized } = await optimizeDocs(\n      docsContent,\n      packageName,\n      config.agent,\n      config.model,\n    )\n\n    if (wasOptimized) {\n      // Clean up output\n      let skillMd = optimized\n        .replace(/^```markdown\\n?/m, '')\n        .replace(/\\n?```$/m, '')\n        .trim()\n\n      // Find the first frontmatter block (skip any header before it)\n      const frontmatterMatch = skillMd.match(/^(.*?)(---\\n[\\s\\S]*?\\n---)/m)\n      if (frontmatterMatch && frontmatterMatch[2]) {\n        // Use content starting from frontmatter\n        skillMd = skillMd.slice(skillMd.indexOf('---'))\n      }\n\n      // Ensure frontmatter exists\n      if (!skillMd.startsWith('---')) {\n        skillMd = `---\nname: ${sanitizeName(packageName)}\ndescription: \"${resolved.description || packageName} - Use this skill when working with ${packageName}.\"\nversion: \"${resolved.version || 'latest'}\"\n---\n\n${skillMd}`\n      }\n\n      // Add documentation navigation section\n      skillMd += `\n\n## Documentation\n\nFor deeper information, read the local docs. The \\`llms.txt\\` file contains an index with relative links to all documentation files:\n\n\\`\\`\\`\n./llms.txt          # Index with links to all docs\n./docs/api/         # API reference\n./docs/guide/       # Guides and tutorials\n./docs/style-guide/ # Style guide rules\n\\`\\`\\`\n\nFollow relative links in llms.txt to read specific documentation files.\n`\n      writeFileSync(join(skillDir, 'SKILL.md'), skillMd)\n      consola.success('Generated SKILL.md')\n    }\n    else {\n      consola.warn('Haiku not available, creating minimal SKILL.md')\n      const skillMd = `---\nname: ${sanitizeName(packageName)}\ndescription: \"${resolved.description || packageName} - Use this skill when working with ${packageName}.\"\nversion: \"${resolved.version || 'latest'}\"\n---\n\n# ${packageName}\n\n${resolved.description || ''}\n\n## Documentation\n\nRaw docs in \\`docs/\\` - use skill-creator to generate optimized content.\n`\n      writeFileSync(join(skillDir, 'SKILL.md'), skillMd)\n    }\n  }\n\n  consola.success(`Synced ${packageName} to ${skillDir}`)\n}\n\nasync function fetchText(url: string): Promise<string | null> {\n  const res = await fetch(url, {\n    headers: { 'User-Agent': 'skilld/1.0' },\n  }).catch(() => null)\n\n  if (!res?.ok) return null\n  return res.text()\n}\n\nasync function fetchReadme(url: string): Promise<string | null> {\n  // Handle ungh:// URLs\n  if (url.startsWith('ungh://')) {\n    const parts = url.replace('ungh://', '').split('/')\n    const owner = parts[0]\n    const repo = parts[1]\n    const subdir = parts.slice(2).join('/')\n\n    const unghUrl = subdir\n      ? `https://ungh.cc/repos/${owner}/${repo}/files/main/${subdir}/README.md`\n      : `https://ungh.cc/repos/${owner}/${repo}/readme`\n\n    const res = await fetch(unghUrl, {\n      headers: { 'User-Agent': 'skilld/1.0' },\n    }).catch(() => null)\n\n    if (!res?.ok) return null\n\n    const text = await res.text()\n    try {\n      const json = JSON.parse(text) as { markdown?: string, file?: { contents?: string } }\n      return json.markdown || json.file?.contents || null\n    }\n    catch {\n      return text\n    }\n  }\n\n  return fetchText(url)\n}\n\n/**\n * Parse markdown links from llms.txt to get .md file paths\n */\nfunction parseMarkdownLinks(content: string): string[] {\n  const links: string[] = []\n  const linkRegex = /\\[([^\\]]+)\\]\\(([^)]+\\.md)\\)/g\n  let match\n\n  while ((match = linkRegex.exec(content)) !== null) {\n    const url = match[2]!\n    if (!links.includes(url)) {\n      links.push(url)\n    }\n  }\n\n  return links\n}\n\n/**\n * Extract sections from llms-full.txt by URL patterns\n * Format: ---\\nurl: /path.md\\n---\\n<content>\\n\\n---\\nurl: ...\n */\nfunction extractSections(content: string, patterns: string[]): string | null {\n  const sections: string[] = []\n  const parts = content.split(/\\n---\\n/)\n\n  for (let i = 0; i < parts.length; i++) {\n    const part = parts[i]!\n    const urlMatch = part.match(/^url:\\s*(.+)$/m)\n    if (!urlMatch) continue\n\n    const url = urlMatch[1]!\n    if (patterns.some(p => url.includes(p))) {\n      // Include content after the url line\n      const contentStart = part.indexOf('\\n', part.indexOf('url:'))\n      if (contentStart > -1) {\n        sections.push(part.slice(contentStart + 1))\n      }\n    }\n  }\n\n  if (sections.length === 0) return null\n  return sections.join('\\n\\n---\\n\\n')\n}\n\nrunMain(main)\n"],"mappings":"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"}